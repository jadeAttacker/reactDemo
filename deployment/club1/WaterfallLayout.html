<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<title>瀑布流布局20170729</title>
	<style type="text/css">

        #container   {width: 635px;height: 600px; overflow: auto;position: relative;}
        #container ul{width: 200px;margin:0 5px 0 0;float: left;padding: 0;}
        #container li{list-style: none;margin: 0;}
         #container p{margin: 0;padding: 0}
	</style>
</head>
<body>
  <center>
     <div id="container">

        --<ul>
            <li><img src="./WaterfallPicture/1.jpg"><p>种豆南山</p></li>
            <li><img src="./WaterfallPicture/4.jpg"><p>种豆南山</p></li>
        </ul>
         <ul>
            <li><img src="./WaterfallPicture/2.jpg"><p>种豆南山</p></li>
            <li><img src="./WaterfallPicture/5.jpg"><p>空谷足音</p></li>
            <li><img src="./WaterfallPicture/4.jpg"><p>种豆南山</p></li>
        </ul>
          <ul>
            <li><img src="./WaterfallPicture/3.jpg"><p>种豆南山</p></li>
            <li><img src="./WaterfallPicture/1.jpg"><p>青山隐隐</p></li>
        </ul>
     </div>
  </center>
  <script type="text/javascript">
      window.onload=function(){
           var oDiv=document.getElementById("container");
           var oUl=document.getElementsByTagName("ul");
           var oLi=document.getElementsByTagName("li");
           oDiv.onscroll=function(){
           	  var viewHeight=oDiv.clientHeight;
           	  var scrollY=oDiv.scrollTop;
           	  console.log(viewHeight+scrollY);
           	   //console.log(scrollY);
           	  for(var i=0;i<oUl.length;i++){
           	  	  var oLi=oUl[i].getElementsByTagName("li");
           	  	  var lastLi=oLi[oLi.length-1];
           	  	  if(posTop(lastLi)<viewHeight+scrollY){
           	  	  	    oUl[i].appendChild(createLi());
           	  	  }
           	  }

           }

           function posTop(opt){
	           	 var top=0;
	           	 while(opt.tagName!="DIV"){//离DIV顶部的距离
	           	 	  // console.log(opt.tagName)
		           	 	top=top+opt.offsetTop;
		           	 	opt=opt.offsetParent;
	           	 }
	           	 return top;
	           }
	       function createLi(){
	       	    var oImg=document.createElement("img");
	       	    oImg.src="./WaterfallPicture/"+Math.ceil(Math.random()*5)+".jpg";
	       	    var oP=document.createElement("p");
	       	    oP.innerHTML="浊酒一杯";
	       	    var oLi=document.createElement("li");
	       	    oLi.appendChild(oImg);
	       	    oLi.appendChild(oP);
	       	    return oLi;

	       }


      }
  </script>
</body>
</html>